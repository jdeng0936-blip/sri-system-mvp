# 🧪 销售AI情报系统 - 完整测试指南

**测试时间：** 2026-02-15 16:00  
**版本：** V2.0（UI集成+智能问答）  

---

## 🚀 快速启动

### 1. 启动应用

```bash
cd ~/Desktop/销售AI情报系统
streamlit run app.py
```

**预期输出：**
```
You can now view your Streamlit app in your browser.

Local URL: http://localhost:8501
Network URL: http://192.168.x.x:8501
```

### 2. 打开浏览器

访问：http://localhost:8501

---

## ✅ 测试场景1：武器库文档上传与向量化

### 步骤

1. **进入武器库**
   - 点击顶部标签：📚 核心技术武器库

2. **选择管理员角色**
   - 如果提示权限不足，选择角色为"销售VP"或"区域总监"

3. **上传测试文档**
   - 在"弹药归属分类"选择：📖 产品参数/白皮书
   - 点击"📎 支持格式"上传文件
   - 选择：`test_data_产品参数.txt`（已自动生成）
   - 点击：🚀 一键向量化并装填入库

### 预期结果

```
🧠 正在解析: test_data_产品参数.txt (1/1)

✅ 成功解析并向量化：test_data_产品参数.txt (1个知识碎片)

───────────────────
✅ 成功: 1
⚠️ 失败: 0
📦 知识碎片: 1
───────────────────

🎯 弹药装填完毕！共生成 1 个知识碎片...
```

### 验证点

- ✅ 进度条正常显示
- ✅ 无错误提示
- ✅ 统计面板更新：文档总数=1，知识碎片=1
- ✅ 文档列表出现新文件
- ✅ 分类视图显示"产品参数/白皮书: 1个碎片"

---

## ✅ 测试场景2：语义搜索功能

### 步骤

1. **在武器库页面**
   - 向下滚动到"🔍 智能搜索"区域

2. **执行语义搜索**
   - 搜索框输入：`防腐涂料技术参数`
   - 搜索方式选择：🧠 语义搜索
   - 按回车或等待自动搜索

### 预期结果

```
✅ 找到 1 个相关结果

🟢 结果 1: test_data_产品参数.txt (产品参数/白皮书)
   相关度: 92%
   文件名: test_data_产品参数.txt
   类型: 产品参数/白皮书
   内容预览: 
   # 万华防腐涂料技术参数
   
   ## 产品型号: WH-2026-A
   
   ### 基本参数
   - 厚度: 200μm
   - 耐腐蚀等级: C5-M...
```

### 验证点

- ✅ 找到相关文档
- ✅ 相关度显示为绿色🟢（>70%）
- ✅ 内容预览正确
- ✅ 可展开查看完整内容

### 额外测试

尝试不同的查询：
- `海洋环境防腐` → 应该找到（语义相似）
- `耐盐雾性能` → 应该找到
- `C5-M等级` → 应该找到
- `太阳能电池板` → 应该找不到

---

## ✅ 测试场景3：关键词搜索对比

### 步骤

1. **切换搜索方式**
   - 搜索方式选择：🔤 关键词搜索
   - 搜索框输入：`防腐涂料`

2. **对比结果**
   - 观察与语义搜索的区别

### 预期结果

- ✅ 关键词搜索应该也能找到（因为文档中包含"防腐涂料"）
- ✅ 相关度计算方式不同（基于匹配次数）

---

## ✅ 测试场景4：客户问答（RAG核心功能）

### 步骤

1. **进入第一现场**
   - 点击顶部标签：🎙️ 第一现场

2. **绑定项目**
   - 如果有项目，选择一个
   - 如果没有，选择"暂无项目"继续

3. **客户提问**
   - 在"客户交互大屏"的输入框输入：
   ```
   你们的涂料在海洋环境下能用多少年？
   ```
   - 按回车发送

### 预期结果

**AI回答示例：**
```
🧠 AI 专家正在检索技术文档库...

根据产品技术参数[文档1]，万华防腐涂料WH-2026-A在海洋大气
环境下的设计使用寿命为15年。

该产品具有以下特点：
- 耐腐蚀等级: C5-M（适用于海洋大气）
- 耐盐雾测试: ≥3000小时
- 附着力: ≥10 MPa

在镇海炼化的应用案例[文档1]中也提到了该产品在类似环境下
的成功应用。

📚 查看参考来源
🟢 [文档1] test_data_产品参数.txt (产品参数/白皮书)

🤖 使用模型: gpt-4o-mini | 上下文长度: xxx 字符 | 检索文档: 1 个
```

### 验证点

- ✅ 显示检索提示
- ✅ 生成的答案基于文档内容
- ✅ 引用了具体参数（15年、C5-M、3000小时等）
- ✅ 显示参考来源
- ✅ 可展开查看来源详情
- ✅ 无错误提示

### 额外测试问题

尝试不同的客户问题：

**问题1：** `这个涂料的厚度是多少？`
- **预期答案：** 应提到"200μm"

**问题2：** `附着力能达到多少？`
- **预期答案：** 应提到"≥10 MPa"

**问题3：** `有哪些成功案例？`
- **预期答案：** 应提到镇海炼化、上海港、大连石化

**问题4：** `你们有太阳能电池板吗？`
- **预期答案：** 应诚实告知"武器库中未找到相关文档"

---

## ✅ 测试场景5：异常处理

### 5.1 空武器库问答

1. **清空武器库**
   - 在武器库管理中点击"⚠️ 清空武器库"
   - 确认清空

2. **尝试问答**
   - 回到第一现场
   - 提问任意问题

**预期结果：**
```
⚠️ 武器库暂无技术文档，无法提供精准答案。

💡 建议：请先在【核心技术武器库】上传相关技术文档。
```

### 5.2 无关问题

上传文档后，问一个完全无关的问题：
```
请介绍一下量子计算机的原理
```

**预期结果：**
```
⚠️ 武器库中未找到相关文档。

💡 建议：尝试调整问题描述，或上传更多相关技术文档。
```

---

## 📊 性能测试

### 上传大文件

1. 准备一个真实的PDF文件（5-10MB）
2. 上传并观察：
   - 解析时间（应该在3-10秒内）
   - 生成的知识碎片数量
   - 无错误提示

### 多文件批量上传

1. 一次性上传3-5个文件
2. 观察：
   - 进度条逐步更新
   - 每个文件独立显示结果
   - 最终统计正确

### 搜索响应速度

1. 上传10个文档后
2. 执行语义搜索
3. 观察：
   - 响应时间应在100ms内
   - 结果按相关度排序

---

## 🐛 常见问题排查

### 问题1：启动失败

**症状：** `streamlit: command not found`

**解决：**
```bash
pip install streamlit
# 或
pip3 install streamlit
```

---

### 问题2：导入错误

**症状：** `ModuleNotFoundError: No module named 'chromadb'`

**解决：**
```bash
pip install chromadb sentence-transformers
```

---

### 问题3：API密钥无效

**症状：** RAG问答失败，提示API错误

**解决：**
1. 检查 OpenAI API 密钥是否正确
2. 在界面侧边栏重新输入API密钥
3. 确认API密钥有足够余额

---

### 问题4：ChromaDB初始化慢

**症状：** 首次运行时卡住很久

**原因：** 下载嵌入模型（~420MB）

**解决：** 等待1-2分钟，仅首次需要

---

### 问题5：搜索无结果

**症状：** 明明上传了文档，但搜索不到

**排查：**
1. 检查文档是否成功入库（查看统计面板）
2. 尝试更换搜索关键词
3. 切换搜索方式（语义/关键词）
4. 查看浏览器控制台是否有错误

---

## ✅ 测试检查清单

完成以下所有项目即表示测试通过：

### 武器库功能
- [ ] 文档上传成功
- [ ] 向量化无错误
- [ ] 统计面板更新正确
- [ ] 文档列表显示
- [ ] 分类视图正确

### 搜索功能
- [ ] 语义搜索工作正常
- [ ] 关键词搜索工作正常
- [ ] 相关度显示正确
- [ ] 可展开查看详情

### RAG问答
- [ ] 问答流程完整
- [ ] 答案基于文档内容
- [ ] 引用来源正确
- [ ] 异常处理优雅

### 性能表现
- [ ] 启动速度快（<5秒）
- [ ] 搜索响应快（<500ms）
- [ ] 问答生成快（<10秒）
- [ ] 无明显卡顿

### 用户体验
- [ ] 界面美观清晰
- [ ] 交互流畅自然
- [ ] 提示信息友好
- [ ] 错误处理优雅

---

## 📹 测试录屏建议

为了更好地展示系统功能，建议录制以下场景：

1. **完整工作流演示**（5分钟）
   - 上传文档 → 搜索测试 → 客户问答

2. **语义理解展示**（2分钟）
   - 同义词搜索对比
   - 不同问法得到相同答案

3. **引用来源展示**（1分钟）
   - 展开查看参考来源
   - 验证答案准确性

---

## 🎯 测试完成后

### 生成测试报告

记录以下信息：

```
测试时间: ___________
测试人员: ___________
测试环境: Mac/Windows/Linux
浏览器: Chrome/Safari/Firefox

测试结果:
  文档上传: ✅/❌
  语义搜索: ✅/❌
  RAG问答: ✅/❌
  性能表现: ✅/❌

发现的问题:
1. _________________
2. _________________

改进建议:
1. _________________
2. _________________
```

---

## 🚀 下一步

测试通过后，可以：

1. **准备真实数据**
   - 上传公司真实的产品手册
   - 上传历史竞标书
   - 上传技术规格书

2. **培训销售团队**
   - 演示系统功能
   - 讲解使用方法
   - 收集反馈意见

3. **正式上线使用**
   - 在真实客户场景测试
   - 收集效果数据
   - 持续优化改进

---

**测试愉快！** 🎉

如有问题，请查看：
- 📖 完整文档：`UI_QA_INTEGRATION_REPORT.md`
- 📝 快速摘要：`UI_QA_SUMMARY.txt`
- 🔧 代码文件：`rag_qa_module.py`
